select name from watches where active = 1;
    for row in rows:
         select count(*),target,watcher_name from public.user_issues where watcher_name = row[name] group by target,watcher_name;
               --watcher_name='gyqv-maven-violation-watch'
         for row in rows
              --Insert into verizon.user_violation_watch_count
                 --Ignore the below step if its a cache repo
                          SELECT distinct sha256, issue_id as XRAYID, path as RepoFullPath, target as RepoName,
                                      watcher_id, watcher_name, severity
                              FROM public.user_issues where target like row[target]
                                             --target 	 '%gyqv-maven-violation-cpu-validation%';
                           --IF Target contains -prod in repo name
                                  -- Insert into verizon.user_violation_prod_Details
                           --ELSE
                                  -- Insert into verizon.user_violation_Details

select repo_name, vsad_name ,portfolio ,file_count ,size_in_gb ,updated_date  from public.vw_repo_file_size_info_daily order by size_in_gb::int desc;
python script for "i have 2 postgres databases Get the list of repos where size exceeds 1000 GB from 1st DB and store it in a Notification table in 2nd DB and get the emails from email table in 2nd DB where reponame in notification is matched and ignore if any email value is null  and send consolidated mail with notification table as attachment using smtp server" after sending mail update all records of stutus column in notification table as inactive
